# Impact Force Inversion from Seismic Signals generated by Debris Flows

This repository details the method and models trained to invert basal impact force from seismic signals generated by debris flow events in the Illgraben catchment. 

## Models
### LSTM (Baseline)
As a baseline, the LSTM model is used. The model class can be found in `./models/LSTM_model.py`. 

### xLSTM - Extended LSTM
For the state of the art model, the xLSTM model is chosen. The model classes can be found in `./model/xLSTM_model.py`. 

## Data Preprocessing
To remove the sensor response, refer to `./data_preprocessing/remove_sr.py`. The original data was in UTC+1 time, to shift it back to UTC+0, `./data_preprocessing/shift_utc.py`. For shifting the peak of the impact force, refer to `./data_preprocessing/shift_peak.py`. In this file, the peak can be shifted using "average" or "dynamic" methods. The usage is as follows :
```bash
python shift_peak.py --time_shift --from_velocity --avg_shift
```

To perform moving average smoothing of the data in 10, 30 and 60 second windows, refer to `./data_preprocessing/smooth_data.py`. The usage is as follows : 
```bash
python smooth_data.py --time_shift "average" --smooth --plot
```

## Model Training
The model training is carried out using files located in `./functions/model/`.